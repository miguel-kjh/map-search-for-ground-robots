function [grid] = discretizeMap(obs, mapSize, worldSize)
    grid = zeros(mapSize, mapSize);
    dimCell = worldSize/mapSize;

    xobs = obs.x;
    yobs = obs.y;
    N = size(xobs, 2);

    for c=1:N
        xv = xobs{c};
        yv = yobs{c};
        for k=1:length(xv)
            if ~isnan(xv(k)) && ~isnan(yv(k))
               [i,j] = get_cell(xv(k), yv(k), mapSize, worldSize);
               grid(i,j) = grid(i,j) + 1;  
            end
        end
    end
    
    % for j = 1:max_grid
    %     aux_i = max_grid;
    %     for i = 1:max_grid/2
    %         aux = grid(i,j);
    %         grid(i,j) = grid(aux_i, j);
    %         grid(aux_i, j) = aux;
    %         aux_i = aux_i - 1;
    %     end
    % end
    
    grid = normalizeGrid(grid);
    
end

function [grid] = normalizeGrid(grid)
    grid = grid - min(grid(:));
    grid = grid ./ max(grid(:));
end

function [i,j] = getMapCell(x, y, ncell, world_size)
    if x > world_size; x = world_size; end
    if y > world_size; y = world_size; end
    if x < 0; x = 1; end
    if y < 0; y = 1; end
    

    dimcell = world_size/ncell;
    
    i = ceil(x/dimcell);
    j = ceil(y/dimcell);
end

